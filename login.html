<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tomato - Login Form</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<link href="css/main.css" rel="stylesheet" />
 
</head>
<body>
<!-- Modal HTML -->
<div class="message container">
  <div class="alert d-none alert-success alert-dismissible fade show" role="alert">
    Successfully Logged Out!
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>  
</div>
<div class="container">

<div class="row">
			<div class="shadow_card" style=" position: absolute;
            left: 50%;
            top: 50%;
            -webkit-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);padding: 15px;padding: 30px;">
                <form action="/examples/actions/confirmation.php" method="post">
                    <!--<h1 class="text1">TOMATO</h1>-->
                    <center><img src="img/logo_tomato.png" style="width: 300px;"></center>
                    <p class="text">Hello!</p>
                    
                    
					<div class="form-group">
						<i class="fa fa-envelope" style="padding-top: 5px; padding-left: 15px;font-size: 24px;"></i> 
                        <input type="text" id="email" class="form-control" placeholder="Email Id" required="required" style="padding-left: 45px;">
                    </div>
                    

                   
					<div class="form-group">
                        <i class="fa fa-lock" style="padding-top: 6px; padding-left: 15px;font-size: 24px;"></i>
						<input type="password" id="password" class="form-control" placeholder="Password" required="required" style="padding-left: 40px;">
                    </div>
                    

				</form>				
                <p class="hint-text small"><a href="signup.html" style="color: #696969;">Signup</a> </p>
                <div class="form-group">
                    <button type="button" onclick="submit_form()" class="btn btn-block">Login</button>
                </div>
                <!--<p class="login">Login &nbsp;<a href="#"><span class="merge"><i class="fa fa-arrow-right"></i></span></a></p>
                <p class="support">Need support call? <b>+44 123456789</b></p>-->
            </div>   
          </div>
          </div>

  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-storage.js"></script>
  <script type="text/javascript" src="scripts/firebase.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>  
  <script type="text/javascript" src="scripts/script.js"></script>
  <script type="text/javascript">
    // Check if the User is logged in
    let user;
            var url_string = window.location.href
        var url = new URL(url_string);
        var status = url.searchParams.get("status");

      $(function () {
        if (status === 'Success')
          $('.alert.alert-success').removeClass('d-none');

      });
    isLoggedIn(function(response) {
        if (response.status === 'Success') {
            user = response.user;
            window.location.href="menu.html";
        }
    });

    function message (type, msg) {
      let message = '<div class="alert alert-' + type + ' alert-dismissible fade show" role="alert"><strong>Failure!</strong> ' + msg + '<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>';
      $('.message').html(message);
    }    

    function submit_form() {
        login($('#email').val(), $('#password').val(), function(response) {
            if (response.status === 'Success')
                window.location.href = "menu.html";
            else
              message('danger', response.error)
        })
    }  
  </script>
</body>
</html>