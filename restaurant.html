<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tomato - Login Form</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<link href="css/main.css" rel="stylesheet" />
 <style type="text/css">
    .pad-card a {
        position: absolute;
        top: -10px;
        right: -10px;
        background: red;
        width: 20px;
        height: 20px;
        cursor: pointer;
        line-height: 20px;
        text-align: center;
        font-weight: 600;
        color: #262626;
        border-radius: 50%;
    }   
 </style>
</head>
<body>


<!-- Modal HTML -->
			<div class="modal-body">
                <form action="/examples/actions/confirmation.php" method="post">
					<!--<h1 class="text1">TOMATO</h1>-->
					<img src="img/logo_tomato.png" style="width: 300px;">
                    <p class="text" style="margin-top: 0px;">Restaurant Profile</p>
                 <div class="container">   
                <div class="row">
                    <div class="col-12" style="padding-bottom: 20px;">
                        <div class="form-group">
                            <label for="exampleFormControlFile1">Upload Logo</label>
                            <input type="file" class="form-control-file" id="exampleFormControlFile1">
                          </div>
                    </div>
                    <br><br>
				  <div class="col-xs-4 col-sm-4 col-md-4">
					<div class="form-group"><b>POC Name</b>
						 <input type="text" id="fullname" class="form-control">
                    </div>
				  </div> 

				  <div class="col-xs-3 col-sm-3 col-md-3">
					<div class="form-group"><b>POC Email ID</b>
						<input type="text" id="email" class="form-control">
                    </div>
				</div> 

				<div class="col-xs-5 col-sm-5 col-md-5">
					<div class="form-group"><b>POC Contact Number</b>
						<input type="number" id="contact" class="form-control">
                    </div>
				</div> 
		   </div>
		   
		      <div class="row">
		         <div class="col-xs-4 col-sm-4 col-md-4">
					<div class="form-group"><b>Manager Name</b>
				  <input type="text" id="manager" class="form-control">
			      </div>
		        </div> 
			 </div>
			 
			 
 
		<div class="row">
            <div class="col-12 label_text">Restaurant Address</div>
			<div class="col-xs-7 col-sm-7 col-md-7">
				<div class="form-group"><b>First Line Address</b>
			 <input type="text" id="first_line_address" class="form-control">
			 </div>
		   </div> 
		   <div class="col-xs-5 col-sm-5 col-md-5">
			<div class="form-group"><b>Street Name</b>
		  <input type="text" id="street" class="form-control">
		  </div>
		</div>
	</div>
 
	         <div class="row">
		           <div class="col-xs-3 col-sm-3 col-md-3">
					<div class="form-group"><b>Town/City</b>
		            <input type="text" id="town" class="form-control">
		          </div>
	           </div> 
			   <div class="col-xs-3 col-sm-3 col-md-3">
				<div class="form-group"><b>State</b>
	               <input type="text" id="state" class="form-control">
	            </div>
		   </div>
		         <div class="col-xs-3 col-sm-3 col-md-3">
					<div class="form-group"><b>Country</b>
			     <input type="text" id="country" class="form-control">
		     </div>
	       </div>
		        <div class="col-xs-3 col-sm-3 col-md-3">    
					<div class="form-group"><b>Post Code</b>
		           <input type="text" id="post" class="form-control">
	          </div>
         </div>
      </div>
  
 
      <div class="row">
        <div class="col-12 label_text">Table Data</div>
        <div class="col-xs-4 col-sm-4 col-md-4">
            <div class="form-group"><b>Table Number</b>
         <input type="number" id="addTable" class="form-control">
         </div>
       </div> 
       <div class="col-xs-4 col-sm-4 col-md-4">
        <div class="form-group"><b>Number of Guests</b>
      <input type="number" id="addGuest" class="form-control">
      </div>
    </div>
    <div class="col-4" style="padding-top: 10px;">
        
        <button type="button" onclick="addtoTable()" class="btn btn-success">Add New Table</button>
    </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="row" id="table-list">
            </div>
        </div>
<!--         <div class="col-4">
            <button type="button" class="btn btn-success">Change</button>
        </div> -->
    </div>

		 <div class="form-group">
			<a href="#"><button type="button" onclick="submit_form()" class="btn btn-block">Create</button><i class='fas fa-chevron-right'></i></a>
		</div>
</div>
	
	   
	 

</div>
</form>				
                
                
                <!--<p class="login">Login &nbsp;<a href="#"><span class="merge"><i class="fa fa-arrow-right"></i></span></a></p>
                <p class="support">Need support call? <b>+44 123456789</b></p>-->
            </div>   
  <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-app.js"></script>

  <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-analytics.js"></script>

  <!-- Add Firebase products that you want to use -->
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.18.0/firebase-storage.js"></script>

  <script type="text/javascript" src="scripts/firebase.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>  
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>	
  <script type="text/javascript" src="scripts/script.js"></script>
  <script type="text/javascript">
  		// Check if the User is logged in
  		let user;
  		isLoggedIn(function(response) {
  			if (response.status === 'Success') {
  				user = response.user;
  				console.log(user.uid);
  				getRequestById(user.uid, function(data) {
  					$(function() {
  						$('#fullname').val(data.request.full_name);
  						$('#email').val(data.request.email);
  						$('#contact').val(data.request.contact);
  						$('#first_line_address').val(data.request.first_line_address);
  						$('#street').val(data.request.street);
  						$('#state').val(data.request.state);
  						$('#town').val(data.request.town);
  						$('#country').val(data.request.country);
  						$('#post').val(data.request.post);
              $('#manager').val(data.request.manager_name);
  					});
  				});
  			}
  		});

      function addtoTable() {
        let table = $('#addTable').val();
        let guests = $('#addGuest').val();
        $('#table-list').append('<div class="col-4 table-guest"><div class="pad-card mr-2">Table Number: <span class="tables">' + table + '</span> Guests: <span class="guests">' + guests + '</span><a href="javascript:void(0)">X</a></div></div>')
      }

      $('#table-list').on('click', 'a', function() {
        $(this).closest('.col-4').remove();
      });



  		function submit_form() {
  			// TODO: Set the changes in available updated data for request
  			let tables = {}
  			$('.table-guest').each(function(index) {
  				tables[$(this).find('.tables').text()] = $(this).find('.guests').text();
  			});
  			saveTables(user.uid, tables, function(response) {
  				console.log(response.status);
  				if (response.status === 'Success') {
  					let imageFile = document.querySelector('input[type="file"]').files[0];
  					let ext = imageFile.name.split('.').pop();
  					storeImage('logos/' + user.uid + '.' + ext, imageFile, function(response) {
  						if (response.status === 'Success') {
  							data = {
  								logo_url: response.url
  							}
  							updateRequest(user.uid, data, function(response) {
  								if (response.status === 'Success')
  									window.location.href = "menu.html";
  							})
  						}
  					});
  				}
  			});
  		}
  </script>              
</body>
</html>